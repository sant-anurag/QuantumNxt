{% extends "home.html" %}
{% load static %}
{% block content %}
<link rel="stylesheet" href="{% static 'css/jd.css' %}">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
<!-- Quill Editor CSS -->
<link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
<style>
    .quill-container {
        height: 200px;
    }
    .ql-editor {
        min-height: 150px;
        line-height: 1.6;
    }
    .ql-editor p {
        margin-bottom: 10px;
    }
    .btn-secondary:hover {
        background-color: #5a6268 !important;
    }
</style>
<div class="jd-form-outer">
<div style="display: flex; align-items: center; margin-bottom: 12px;">
    <i class="fas fa-file-alt" style="font-size:2em; color:#5661d2; margin-right: 12px;"></i>
    <h2 style="margin: 0;">Create Job Description</h2>
</div>
    {% if messages %}
        <ul class="messages">
            {% for message in messages %}
                <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>
                    <p class="alert {% if 'error' in message.tags %}text-red-600 error{% elif 'success' in message.tags %}text-green-600 success{% endif %} mb-4">{{ message }}</p>
                </li>
            {% endfor %}
        </ul>
    {% endif %}

    <form id="jdForm" method="post" action="{% url 'create_jd' %}" class="jd-grid-form">
        {% csrf_token %}
        <div class="form-group">
            <label for="jd_summary">Job Title/ JD Summary</label>
            <input 
                type="text" 
                id="jd_summary" 
                name="jd_summary" 
                required 
                maxlength="100"
                placeholder="Brief summary of the job description (max 100 characters)"
                title="Enter a brief summary of the job description (max 100 characters)">
        </div>
        <div class="form-group">
            <label for="companySearch">Company</label>
            <div class="searchable-select">
                <input type="text" id="companySearch" placeholder="Search and select company..." autocomplete="off" required>
                <input type="hidden" name="company_id" id="companyId" required>
                <div class="dropdown-arrow">
                    <i class="fas fa-chevron-down"></i>
                </div>
                <div class="dropdown-options" id="companyDropdown">
                    {% for company in companies %}<div class="dropdown-option" data-value="{{ company.company_id }}" data-text="{{ company.company_name }}">{{ company.company_name }}</div>{% endfor %}
                </div>
            </div>
        </div>
        <div class="form-group form-group-full">
            <label for="jd_description">JD Description</label>
            <div style="margin-bottom: 10px;">
                <button type="button" id="formatTextBtn" class="btn-secondary" style="font-size: 12px; padding: 5px 10px; background-color: #6c757d; color: white; border: none; border-radius: 3px; cursor: pointer;">
                    üìù Format Pasted Text (Convert Line Breaks)
                </button>
                <small style="color: #666; margin-left: 10px;">Click after pasting text from PDF to properly format line breaks</small>
            </div>
            <div id="jd_description_editor" class="quill-container"></div>
            <textarea name="jd_description" id="jd_description" required style="display:none;"></textarea>
        </div>
        <div class="form-group form-group-skills-row">
            <div class="skills-group">
                <label for="must_have_skills">Must Have Skills</label>
                <textarea name="must_have_skills" id="must_have_skills" required rows="3" placeholder="Enter required skills, one per line or separated by commas"></textarea>
            </div>
            <div class="skills-group">
                <label for="good_to_have_skills">Good to Have Skills</label>
                <textarea name="good_to_have_skills" id="good_to_have_skills" rows="3" placeholder="Enter preferred skills, one per line or separated by commas"></textarea>
            </div>
        </div>
        <div class="form-group">
            <label for="budget_ctc">Budget/CTC</label>
            <input type="text" name="budget_ctc" id="budget_ctc" maxlength="50" placeholder="e.g., Market Standard, 10 LPA" required>
        </div>
        <div class="form-group">
            <label for="experience_required">Experience Required</label>
            <input type="text" name="experience_required" id="experience_required" maxlength="255" placeholder="e.g., 3-5 years">
        </div>
        <div class="form-group">
            <label for="education_required">Education Required</label>
            <input type="text" name="education_required" id="education_required" maxlength="255" placeholder="e.g., Bachelor's in Computer Science">
        </div>
        <div class="form-group">
            <label for="location">Location</label>
            <input type="text" name="location" id="location" maxlength="255" placeholder="e.g., New York, Remote" required>
        </div>
        <div class="form-group">
            <label for="no_of_positions">No. of Positions</label>
            <input type="number" name="no_of_positions" id="no_of_positions" min="1" value="1" required>
        </div>
        <div class="form-group">
            <label for="jd_status">Status</label>
            <select name="jd_status" id="jd_status">
                <option value="active">Active</option>
                <option value="closed">Closed</option>
                <option value="on hold">On Hold</option>
            </select>
        </div>
        <div class="form-group form-actions form-group-full">
            <button type="submit" class="btn-primary">Create JD</button>
        </div>
    </form>
</div>
<!-- Quill Editor JS -->
<script src="https://cdn.quilljs.com/1.3.6/quill.min.js"></script>
<script src="{% static 'js/jd.js' %}"></script>

{% endblock %}