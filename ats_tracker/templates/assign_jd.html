{% extends "home.html" %}
{% load static %}
{% block content %}
<link rel="stylesheet" href="{% static 'css/assign_jd.css' %}">
<div class="assign-jd-main">
    <header class="assign-jd-header" style="display: flex; align-items: center; justify-content: flex-start; gap: 12px;">
        <i class="fas fa-link" style="font-size: 2em; color: #5661d2;"></i>
        <h2 style="margin: 0;">Assign JD to Team</h2>
    </header>
    <div class="assign-jd-form">
        <div class="assign-jd-group">
            <label for="assign-jd-select">Select JD</label>
            <div class="assign-jd-dropdown">
                <input type="text" id="jd-search-box" class="assign-jd-search" placeholder="Search JD ID or Summary...">
                <select id="assign-jd-select" size="6"></select>
            </div>
        </div>
        <div class="assign-jd-group">
            <label for="assign-team-select">Select Team</label>
            <div class="assign-jd-dropdown">
                <input type="text" id="team-search-box" class="assign-jd-search" placeholder="Search Team Name...">
                <select id="assign-team-select" size="6"></select>
            </div>
        </div>
        <div class="assign-jd-actions">
            <button id="assign-btn" class="assign-jd-btn-primary"><i class="fas fa-check"></i> Assign</button>
            <button id="reset-btn" class="assign-jd-btn-secondary"><i class="fas fa-undo"></i> Reset</button>
        </div>
    </div>
    <div id="assign-jd-result" class="assign-jd-result" style="display:none;"></div>

    <div class="assingment-table">
        <h3>Recent JD Assignments</h3>
        <div class="assignments-table-container">
            <table class="assignments-table">
                <thead>
                    <tr>
                        <th>#</th>
                        <th>JD ID</th>
                        <th>JD Summary</th>
                        <th>No. of Positions</th>
                        <th>Company Name</th>
                        <th>Team Name</th>
                    </tr>
                </thead>
                <tbody id="assignments-tbody">
                    {% for assignment in jds %}
                    <tr>
                        <td>{{ forloop.counter|add:pagination.offset }}</td>
                        <td>{{ assignment.jd_id }}</td>
                        <td title="{{ assignment.jd_summary }}">{{ assignment.jd_summary }}</td>
                        <td>{{ assignment.no_of_positions }}</td>
                        <td title="{{ assignment.company_name }}">{{ assignment.company_name }}</td>
                        <td title="{{ assignment.team_name }}">{{ assignment.team_name }}</td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="6" class="no-records">No JD assignments found.</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        <div id="assignments-pagination" class="pagination">
            {% if pagination.num_pages > 1 %}
                <div class="pagination-controls">
                    {% if pagination.has_previous %}
                        <a href="?page=1" class="pagination-btn first">&laquo; First</a>
                        <a href="?page={{ pagination.previous_page }}" class="pagination-btn prev">Previous</a>
                    {% else %}
                        <span class="pagination-btn disabled">&laquo; First</span>
                        <span class="pagination-btn disabled">Previous</span>
                    {% endif %}
                    
                    <span class="pagination-info">
                        Page {{ pagination.current_page }} of {{ pagination.num_pages }}
                    </span>
                    
                    {% if pagination.has_next %}
                        <a href="?page={{ pagination.next_page }}" class="pagination-btn next">Next</a>
                        <a href="?page={{ pagination.num_pages }}" class="pagination-btn last">Last &raquo;</a>
                    {% else %}
                        <span class="pagination-btn disabled">Next</span>
                        <span class="pagination-btn disabled">Last &raquo;</span>
                    {% endif %}
                </div>
            {% endif %}
        </div>
    </div>
</div>
<script src="{% static 'js/assign_jd.js' %}"></script>
{% endblock %}